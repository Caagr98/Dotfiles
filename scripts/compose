#!/usr/bin/env python3
import sys
import re
import dmenu
import xtype

keys = []
chars = {}
with open(sys.argv[1], "rt") as file:
	for line in file:
		line = line.rstrip('\n').split("#", 1)[0].strip()
		if not line:
			continue
		v, k = line.split(" ")
		k += " " + chr(int(v, 16))
		keys.append(k)
		chars[k] = chr(int(v, 16))

code = dmenu.show(keys)

if code is not None:
	rx = re.compile("#x?([0-9]+)")

	char = None
	if code in chars:
		char = chars[code]
	elif rx.match(code):
		char = chr(int(rx.match(code).group(1), 16))

	if char:
		xtype.xtype([xtype.get_char(char)])
